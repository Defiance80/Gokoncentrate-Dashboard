/*! For license information please see auth.min.js.LICENSE.txt */
(()=>{"use strict";function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function s(e,o,a,i){var s=o&&o.prototype instanceof u?o:u,l=Object.create(s.prototype);return t(l,"_invoke",function(e,t,o){var a,i,s,u=0,l=o||[],d=!1,m={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(e,t){return a=e,i=0,s=n,m.n=t,c}};function f(e,t){for(i=e,s=t,r=0;!d&&u&&!o&&r<l.length;r++){var o,a=l[r],f=m.p,v=a[2];e>3?(o=v===t)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=f&&((o=e<2&&f<a[1])?(i=0,m.v=t,m.n=a[1]):f<v&&(o=e<3||a[0]>t||t>v)&&(a[4]=e,a[5]=t,m.n=v,i=0))}if(o||e>1)return c;throw d=!0,t}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,v),i=l,s=v;(r=i<2?n:s)||!d;){a||(i?i<3?(i>1&&(m.n=-1),f(i,s)):m.n=s:m.v=s);try{if(u=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((r=(d=m.n<0)?s:e.call(t,m))!==c)break}catch(e){a=n,i=1,s=e}finally{u=1}}return{value:r,done:d}}}(e,a,i),!0),l}var c={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var m=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),f=d.prototype=u.prototype=Object.create(m);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=d,t(f,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,i,"GeneratorFunction"),t(f),t(f,i,"Generator"),t(f,a,function(){return this}),t(f,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:v}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function i(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(i("next",0),i("throw",1),i("return",2))},t(e,n,r,o)}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,c,"next",e)}function c(e){r(i,o,a,s,c,"throw",e)}s(void 0)})}}var a=function(e,t){return window.localisation&&window.localisation[e]||t},i=function(e,t){var n=document.querySelector("#".concat(e)),r=document.querySelector("#".concat(t));n&&r&&n.addEventListener("click",function(){var e="password"===r.getAttribute("type")?"text":"password";r.setAttribute("type",e),n.classList.toggle("ph-eye"),n.classList.toggle("ph-eye-slash")})};function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function c(e){var t=e.length>=8&&e.length<=14,n=/[A-Z]/.test(e),r=/[a-z]/.test(e),o=/[!@#$%^&*(),.?":{}|<>]/.test(e),a=/\d/.test(e);return t&&n&&r&&o&&a}function u(e,t){var n,r=e.closest(".input-group"),o=r?r.querySelector(".invalid-feedback"):null;!o&&null!=r&&null!==(n=r.nextElementSibling)&&void 0!==n&&n.classList.contains("invalid-feedback")&&(o=r.nextElementSibling),o&&(o.textContent=t,o.style.display="block"),e.classList.add("is-invalid")}function l(e){var t,n=e.closest(".input-group"),r=n?n.querySelector(".invalid-feedback"):null;!r&&null!=n&&null!==(t=n.nextElementSibling)&&void 0!==t&&t.classList.contains("invalid-feedback")&&(r=n.nextElementSibling),r&&(r.textContent="",r.style.display="none"),e.classList.remove("is-invalid")}function d(e,t,n,r){t.textContent=e?n:r,t.disabled=e}function m(e,t){t.forEach(function(t){var n=e.querySelector('input[name="'.concat(t,'"]'));n&&n.addEventListener("input",function(){return l(n)})})}i("togglePassword","password"),i("toggleConfirmPassword","confirm_password");var f=document.querySelector("#registerForm");if(f){var v=function(){var e=!0,t=f.querySelector('input[name="first_name"]'),n=f.querySelector('input[name="last_name"]'),r=f.querySelector('input[name="email"]'),o=f.querySelector('input[name="password"]'),i=f.querySelector('input[name="confirm_password"]'),l=f.querySelector('input[name="mobile"]');return t.value.trim()||(u(t,a("first_name_required","First Name field is required.")),e=!1),n.value.trim()||(u(n,a("last_name_required","Last Name field is required.")),e=!1),r.value.trim()?s(r.value)||(u(r,a("email_invalid","Enter a valid Email Address.")),e=!1):(u(r,a("email_required","Email field is required.")),e=!1),l.value.trim()||(u(l,a("mobile_required","Mobile field is required.")),e=!1),o.value.trim()?c(o.value)||(u(o,a("password_requirements","Password length should be 8 to 14 Characters, at least one uppercase, one lowercase, one digit, and one special character")),e=!1):(u(o,a("password_required","Password field is required.")),e=!1),i.value.trim()||(u(i,a("confirm_password_required","Confirm Password field is required.")),e=!1),o.value!==i.value&&(u(i,a("passwords_confirm_mismatch","Passwords and confirm password do not match.")),e=!1),e},p=document.querySelector("#register-button"),g=document.querySelector("#error_message"),b=document.querySelector('meta[name="base-url"]').getAttribute("content");[f.querySelector('input[name="first_name"]'),f.querySelector('input[name="last_name"]')].forEach(function(e){e.addEventListener("input",function(){var t=/[0-9]/g;t.test(e.value)?(e.value=e.value.replace(t,""),u(e,a("name_no_numbers","Name field does not allow numbers."))):e.value.trim()?l(e):u(e,a("field_required","This field is required."))})}),m(f,["first_name","last_name","email","password","confirm_password"]);var y=f.querySelector('input[name="password"]');if(y){var _=function(e,t){var n=e.value;n&&t!==n?u(e,a("passwords_do_not_match","Passwords do not match")):n&&t===n?l(e):n||l(e)};["copy","paste","cut"].forEach(function(e){y.addEventListener(e,function(e){return e.preventDefault()})}),y.addEventListener("input",function(){var e=this.value;e&&!c(e)?u(this,a("password_requirements","Password length should be 8 to 14 Characters, at least one uppercase, one lowercase, one digit, and one special character")):e&&c(e)&&l(this);var t=f.querySelector('input[name="confirm_password"]');t&&t.value&&_(t,e)});var h=f.querySelector('input[name="confirm_password"]');h&&(["copy","paste","cut"].forEach(function(e){h.addEventListener(e,function(e){return e.preventDefault()})}),h.addEventListener("input",function(){var e=y.value;this.value;_(this,e)}))}f.addEventListener("submit",function(){var t=o(e().m(function t(r){var o,i,s,c,u,l,m,y,_,h,w,S;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.preventDefault(),v()){e.n=1;break}return e.a(2);case 1:return d(!0,p,a("signing_up","Signing Up..."),a("sign_up","Sign Up")),g.textContent="",e.p=2,o=new FormData(this),(i=f.querySelector('input[name="mobile"]'))&&void 0!==window.iti&&window.iti&&((s=window.iti.getNumber()||"")&&o.set("mobile",s),window.iti.getSelectedCountryData&&(c=window.iti.getSelectedCountryData())&&c.dialCode&&o.set("country_code",c.dialCode)),e.n=3,fetch("".concat(b,"/api/register?is_ajax=1"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:o});case 3:return u=e.v,e.n=4,u.json();case 4:if(l=e.v,u.ok&&l.status){e.n=5;break}if(i&&void 0!==window.iti&&window.iti)try{(s=window.iti.getNumber()||"")&&(c=window.iti.getSelectedCountryData&&window.iti.getSelectedCountryData(),(m=c&&c.dialCode?"+"+c.dialCode:"")&&s.startsWith(m)&&(y=s.replace(m,""),window.iti.setNumber(y)))}catch(e){console.error("Error resetting phone:",e)}return _=[],_=l.errors&&"object"===n(l.errors)?Object.values(l.errors).flat():l.message&&"object"===n(l.message)?Object.values(l.message).flat():"string"==typeof l.message?[l.message]:[a("register_error_generic","An error occurred during registration")],g.textContent=_.join("\n"),e.a(2);case 5:return e.n=6,fetch("".concat(b,"/api/login?is_ajax=1"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:o});case 6:return h=e.v,e.n=7,h.json();case 7:!0===(w=e.v).status?(window.successSnackbar&&window.successSnackbar(a("register_success","Register successfully!")),setTimeout(function(){window.location.href="".concat(b,"/manage-profile")},1e3)):g.textContent=w.message||a("login_after_register_failed","Login after registration failed."),e.n=9;break;case 8:e.p=8,S=e.v,console.error("Registration error:",S),g.textContent=a("system_error","A system error occurred. Please try again later.");case 9:return e.p=9,d(!1,p,"",a("sign_up","Sign Up")),e.f(9);case 10:return e.a(2)}},t,this,[[2,8,9,10]])}));return function(e){return t.apply(this,arguments)}}())}var w=document.querySelector("#login-form");if(w){var S=function(){var e=!0,t=w.querySelector('input[name="email"]'),n=w.querySelector('input[name="password"]');return t.value.trim()?s(t.value)||(u(t,a("email_invalid","Enter a valid Email Address.")),e=!1):(u(t,a("email_required","Email field is required.")),e=!1),n.value.trim()||(u(n,a("password_required","Password field is required.")),e=!1),e},C=document.querySelector("#login-button"),q=document.querySelector("#login_error_message"),x=document.querySelector('meta[name="base-url"]').getAttribute("content");m(w,["email","password"]);var E=w.querySelector('input[name="password"]');E&&["copy","paste","cut"].forEach(function(e){E.addEventListener(e,function(e){return e.preventDefault()})}),w.addEventListener("submit",function(){var t=o(e().m(function t(n){var r,o,i,s,c,u,l;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.preventDefault(),S()){e.n=1;break}return e.a(2);case 1:return d(!0,C,a("signing_in","Signing In..."),a("sign_in","Sign In")),q.textContent="",e.p=2,r=new FormData(this),e.n=3,fetch("".concat(x,"/api/login?is_ajax=1"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:r});case 3:if(o=e.v,!(o.headers.get("content-type")||"").includes("application/json")){e.n=5;break}return e.n=4,o.json();case 4:u=e.v,e.n=6;break;case 5:u={};case 6:if(i=u,406!==o.status){e.n=7;break}return q.textContent=i&&(i.message||i.error)?i.message||i.error:a("device_limit_reached","Your device limit has been reached."),s=i&&i.other_device?i.other_device:[],renderDeviceLimitUI(s),e.a(2);case 7:if(o.ok&&!1!==i.status){e.n=8;break}return c=i&&(i.errors?Object.values(i.errors).flat()[0]:i.message)||a("login_failed","Login failed"),q.textContent=c,e.a(2);case 8:window.successSnackbar&&window.successSnackbar(a("login_success","Login successfully!")),setTimeout(function(){window.location.href="".concat(x,"/manage-profile")},1e3),e.n=10;break;case 9:e.p=9,l=e.v,console.error("Login error:",l),q.textContent=a("system_error","A system error occurred. Please try again later.");case 10:return e.p=10,d(!1,C,"",a("sign_in","Sign In")),e.f(10);case 11:return e.a(2)}},t,this,[[2,9,10,11]])}));return function(e){return t.apply(this,arguments)}}()),window.renderDeviceLimitUI=function(t){var n=document.getElementById("device-limit-section");if(!n){(n=document.createElement("div")).id="device-limit-section",n.className="mt-3";var r=w.querySelector(".full-button");r&&r.parentNode?r.parentNode.insertBefore(n,r.nextSibling):w.appendChild(n)}n.innerHTML="";var i=document.createElement("div");i.className="alert alert-warning mb-2 device-limit-alert",i.textContent=a("device_limit_instruction","Select a device to logout, then click Sign In again.");var s=document.createElement("div");s.className="text-end mb-3";var c=document.createElement("button");c.type="button",c.className="btn btn-danger btn-sm",c.textContent=a("logout_all_devices","Logout All Devices"),s.appendChild(c),c.addEventListener("click",o(e().m(function r(){var o,i,s,u;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(c.disabled=!0,c.textContent=a("logging_out_all_devices","Logging out all devices..."),q.textContent="",e.p=1,o=t&&t.length>0?t[0].user_id:null){e.n=2;break}return q.textContent=a("unable_to_determine_user","Unable to determine user ID."),c.disabled=!1,c.textContent=a("logout_all_devices","Logout All Devices"),e.a(2);case 2:return e.n=3,fetch("".concat(x,"/api/logout-all-data?user_id=").concat(encodeURIComponent(o)),{method:"GET",credentials:"same-origin"});case 3:return i=e.v,e.n=4,i.json().catch(function(){return{}});case 4:if(s=e.v,i.ok&&(!s||!1!==s.status)){e.n=5;break}return q.textContent=s&&s.message?s.message:a("failed_logout_all","Failed to logout all devices."),c.disabled=!1,c.textContent=a("logout_all_devices","Logout All Devices"),e.a(2);case 5:n.innerHTML="",(u=document.createElement("div")).className="alert alert-success",u.textContent=a("all_devices_logged_out","All devices have been logged out. Click Sign In again to continue."),n.appendChild(u),e.n=7;break;case 6:e.p=6,e.v,q.textContent=a("system_error","A system error occurred. Please try again later."),c.disabled=!1,c.textContent=a("logout_all_devices","Logout All Devices");case 7:return e.a(2)}},r,null,[[1,6]])})));var u=document.createElement("div");if(u.className="list-group mb-2",t&&0!==t.length)t.forEach(function(t){var r=document.createElement("div");r.className="list-group-item d-flex align-items-center justify-content-between";var i=document.createElement("div");i.className="d-flex flex-column";var c=document.createElement("span");c.textContent="".concat(t.device_name||"Device"," (").concat(t.platform||"unknown",")");var l=document.createElement("small");l.className="text-muted",l.textContent=t.device_id||"",i.appendChild(c),i.appendChild(l);var d=document.createElement("button");d.type="button",d.className="btn btn-sm btn-outline-danger",d.textContent=a("logout","Logout"),d.addEventListener("click",o(e().m(function o(){var i,c,l,m,f,v,p,g;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return d.disabled=!0,i=d.textContent,d.innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+a("logging_out","Logging out..."),q.textContent="",e.p=1,c=t.user_id,e.n=2,fetch("".concat(x,"/api/device-logout-data?user_id=").concat(encodeURIComponent(c),"&device_id=").concat(encodeURIComponent(t.device_id)),{method:"GET"});case 2:return l=e.v,e.n=3,l.json().catch(function(){return{}});case 3:if(m=e.v,l.ok&&(!m||!1!==m.status)){e.n=4;break}return q.textContent=m&&m.message?m.message:a("failed_delete_device","Failed to delete device."),d.disabled=!1,d.textContent=i,e.a(2);case 4:if(r.remove(),0!==u.querySelectorAll(".list-group-item").length){e.n=5;break}return(f=n.querySelector(".device-limit-alert"))&&f.remove(),s&&s.parentNode&&s.remove(),n.innerHTML="",(v=document.createElement("div")).className="alert alert-success",v.textContent=a("all_devices_logged_out","All devices have been logged out. Click Sign In again to continue."),n.appendChild(v),e.a(2);case 5:(p=n.querySelector(".text-success, .alert-success"))&&p.remove(),(g=document.createElement("div")).className="text-success mb-2",g.textContent=a("device_removed_info","Device removed. Click Sign In again to continue."),n.insertBefore(g,n.firstChild),e.n=7;break;case 6:e.p=6,e.v,q.textContent=a("system_error","A system error occurred. Please try again later."),d.disabled=!1,d.textContent=a("logout","Logout");case 7:return e.a(2)}},o,null,[[1,6]])}))),r.appendChild(i),r.appendChild(d),u.appendChild(r)});else{var l=document.createElement("div");l.className="text-muted",l.textContent=a("no_devices_found","No devices found."),u.appendChild(l)}n.appendChild(i),n.appendChild(s),n.appendChild(u)}}var k=document.querySelector("#forgetpassword-form");if(k){var L=function(){var e=!0,t=k.querySelector('input[name="email"]');return t.value.trim()?s(t.value)||(u(t,a("email_invalid","Enter a valid Email Address.")),e=!1):(u(t,a("email_required","Email field is required.")),e=!1),e},j=document.querySelector("#forget_password_btn"),N=document.querySelector("#forgetpassword_error_message"),A=document.querySelector("#forget_password_msg"),P=document.querySelector('meta[name="base-url"]').getAttribute("content");m(k,["email"]),k.addEventListener("submit",function(){var t=o(e().m(function t(n){var r,o,i,s,c;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.preventDefault(),L()){e.n=1;break}return e.a(2);case 1:return d(!0,j,a("sending","Sending..."),a("submit","Submit")),N.textContent="",A.classList.add("d-none"),e.p=2,r=new FormData(this),e.n=3,fetch("".concat(P,"/api/forgot-password?is_ajax=1"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:r});case 3:return o=e.v,e.n=4,o.json();case 4:if(i=e.v,o.ok&&i.status){e.n=5;break}return s=i.errors?Object.values(i.errors).flat()[0]:i.message||a("password_reset_failed","Password reset failed"),N.textContent=s,e.a(2);case 5:A.classList.remove("d-none"),k.reset(),e.n=7;break;case 6:e.p=6,c=e.v,console.error("Forgot password error:",c),N.textContent=a("system_error","A system error occurred. Please try again later.");case 7:return e.p=7,d(!1,j,"",a("submit","Submit")),e.f(7);case 8:return e.a(2)}},t,this,[[2,6,7,8]])}));return function(e){return t.apply(this,arguments)}}())}})();
//# sourceMappingURL=auth.min.js.map