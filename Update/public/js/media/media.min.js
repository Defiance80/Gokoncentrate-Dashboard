(()=>{function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,d,r,o=[],l=!0,c=!1;try{if(d=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=d.call(n)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var n="",i=document.querySelector('meta[name="base-url"]');i&&(n=i.getAttribute("content"));var a=document.getElementById("exampleModal"),d=document.getElementById("media-container"),r=document.getElementById("mediaLibraryContent");function o(e,t,i,a,d,r,l){var c=e.slice(i,a),s=new FormData;s.append("file_chunk",c),s.append("index",t),s.append("total_chunks",Math.ceil(e.size/d)),s.append("file_name",e.name);var u=new XMLHttpRequest;u.upload.addEventListener("progress",function(n){if(n.lengthComputable){var a=i+n.loaded,d=Math.min(100,a/e.size*100);r[t].progressBar.style.width=d+"%",l.style.visibility="visible"}}),u.open("POST","".concat(n,"/app/media-library/upload"),!0),u.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),u.onload=function(){if(200===u.status&&JSON.parse(u.responseText).success)if(a<e.size)i=a,a=Math.min(i+d,e.size),o(e,t,i,a,d,r,l);else{r[t].progressBar.style.width="100%",l.style.visibility="hidden";var n=r.find(function(t){return t.file===e});n&&(n.done=!0),updateUploadSubmitState()}},u.send(s)}document.addEventListener("DOMContentLoaded",function(){var e="",t="",i="",d=0;function o(e){e.addEventListener("click",function(){t=this.getAttribute("data-image-container"),i=this.getAttribute("data-hidden-input")})}function l(){document.querySelectorAll('button[data-bs-target="#exampleModal"]').forEach(function(e){o(e)})}function c(t,n){e=t,document.querySelectorAll("#mediaLibraryContent img, #mediaLibraryContent video").forEach(function(e){e.classList.remove("iq-image")}),n.classList.add("iq-image")}window.mediaSelection={setCurrentImageContainer:function(e){t=e},setCurrentHiddenInput:function(e){i=e},getCurrentImageContainer:function(){return t},getCurrentHiddenInput:function(){return i}},window.updateUploadSubmitState=function(){var e=document.getElementById("submitButton");if(e){var t=(window.uploadedFiles||[]).filter(function(e){return!e.removed}),n=t.length>0&&t.every(function(e){return!0===e.done});e.disabled=!n}},window.initializeImageSelection=o,window.initializeModal=l;var s=document.getElementById("mediaLibraryContent");s&&s.addEventListener("click",function(e){if("IMG"===e.target.tagName)c(t=e.target.src,e.target);else if("VIDEO"===e.target.tagName){var t;(t=e.target.querySelector("source").src)&&c(t,e.target),e.preventDefault()}});var u=document.getElementById("mediaSubmitButton");u&&u.addEventListener("click",function(){if(e&&t&&i){var n=document.getElementById(t),a=document.getElementById(i);if(n){if(a.value=e,n.innerHTML="",a.hasAttribute("data-validation")){var d=document.getElementById("file-error"),r=document.getElementById("trailer-file-error"),o=document.querySelector('input[name="video_file_input"]'),l=document.querySelector('input[name="image_input4"]'),c="file_url_trailer"===a.id||"trailer_video"===a.name;if(e.endsWith(".mp4")||e.endsWith(".avi")||e.endsWith(".mov")||e.endsWith(".webm")){d&&(d.style.display="none"),r&&(r.style.display="none"),o&&o.removeAttribute("required");var s=document.createElement("video");s.src=e,s.controls=!0,s.classList.add("img-fluid","mb-2"),s.style.maxWidth="300px",s.style.maxHeight="300px",n.appendChild(s),(v=document.createElement("span")).innerHTML="&times;",v.classList.add("remove-media-icon"),v.style.cursor="pointer",v.style.fontSize="24px",v.style.position="absolute",v.addEventListener("click",function(){n.innerHTML="",a.value="",o&&(o.value=""),l&&l.setAttribute("required","required"),d&&(d.style.display="block"),r&&(r.style.display="block"),n.querySelectorAll(".text-danger").forEach(function(e){e.remove()})}),l&&l.removeAttribute("required"),n.appendChild(v)}else{if(n.querySelectorAll(".text-danger").forEach(function(e){e.remove()}),c&&"file_url3"===a.id)if(m=document.querySelector("#url_file_input > div:last-child"))m.querySelectorAll(".text-danger").forEach(function(e){e.textContent.includes("Only video files")&&e.remove()});if(a.value="",o&&o.setAttribute("required","required"),d&&(d.style.display="none"),r&&(r.style.display="none"),e&&""!==e.trim())if((p=document.createElement("div")).classList.add("text-danger","mt-1"),p.style.fontSize="14px",p.style.fontWeight="500",p.style.display="block",p.textContent="Only video files are allowed.",c&&"file_url3"===a.id){var u=document.querySelector("#url_file_input .input-group"),m=document.querySelector("#url_file_input > div:last-child");if(u&&m)m.querySelectorAll(".text-danger").forEach(function(e){e.textContent.includes("Only video files")&&e.remove()}),m.insertBefore(p,u.nextSibling);else n.appendChild(p)}else n.appendChild(p)}}else if(e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".webp")){var v,f=document.createElement("img");f.src=e,f.classList.add("img-fluid","mb-2"),f.style.maxWidth="100px",f.style.maxHeight="100px",n.appendChild(f),(v=document.createElement("span")).innerHTML="&times;",v.classList.add("remove-media-icon"),v.style.cursor="pointer",v.style.fontSize="24px",v.addEventListener("click",function(){n.innerHTML="",a.value=""}),n.appendChild(v)}else{var p;(p=document.createElement("div")).classList.add("text-danger"),p.textContent="Only image files are allowed.",n.appendChild(p),document.querySelectorAll(".input-group-text.form-control").forEach(function(e){e&&(e.innerHTML="")})}$("#exampleModal").modal("hide")}}});var m=document.getElementById("submitButton");function v(){var e=document.getElementById("media-container"),t=(document.getElementById("loading-spinner"),document.getElementById("mediaLibraryContent"),!1),i=!0;!t&&i&&(t=!0,fetch("".concat(n,"/app/media-library/getMediaStore?page=").concat(page,"&perPage=").concat(21)).then(function(e){return e.json()}).then(function(t){t.html?(1===page&&(e.innerHTML=""),e.insertAdjacentHTML("beforeend",t.html),t.hasMore?page++:i=!1):console.log("No data received")}).catch(function(e){return console.error("Error:",e)}).finally(function(){t=!1}))}function f(){r&&r.scrollTop+r.clientHeight>=r.scrollHeight-100&&v()}function p(e){e.find(".video_quality_type").on("change",function(){var t=$(this).val(),n=e.find(".quality_video_file_input"),i=e.find(".quality_video_input"),a=e.find('input[name="quality_video[]"]'),d=e.find('input[name="quality_video_url_input[]"]');"Local"===t?(n.removeClass("d-none"),i.addClass("d-none"),a.val(a.val()).trigger("change"),d.val("").trigger("change")):(n.addClass("d-none"),i.removeClass("d-none"),d.val(d.val()).trigger("change"),a.val("").trigger("change"))}).trigger("change")}function g(e){e.find(".download_quality_video_type").on("change",function(){var t=$(this).val(),n=e.find(".download-video-file-input"),i=e.find(".download-video-url-input");n.addClass("d-none"),i.addClass("d-none"),"Local"===t?n.removeClass("d-none"):"URL"===t&&i.removeClass("d-none")}).trigger("change")}function h(e){e.find("select.select2").each(function(){$(this).data("select2")&&$(this).select2("destroy")})}function y(e){e.find("select.select2").each(function(){$(this).select2({width:"100%"})})}m&&(m.disabled=!0,m.addEventListener("click",function(e){document.getElementById("media-container");e.preventDefault(),window.uploadedFiles=window.uploadedFiles||[];var t=window.uploadedFiles.filter(function(e){return!e.removed}),i=t.length>0&&t.every(function(e){return!0===e.done});if(t.length>0&&!i)return alert("Please wait for all files to finish uploading before saving."),!1;m.disabled=!0,m.innerText="Loading...",window.uploadedFiles=window.uploadedFiles||[];var a=new FormData,d=window.uploadedFiles.filter(function(e){return!e.removed});if(d.length>0){document.getElementById("file_url_media").removeAttribute("required"),document.getElementById("file_url_media-error").style.display="none";for(var o=0;o<d.length;o++)a.append("file_url[]",d[o].file);var l=document.getElementById("page_type");l&&a.append("page_type",l.value);var c=new XMLHttpRequest;c.open("POST","".concat(n,"/app/media-library/store"),!0),c.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),c.onloadstart=function(){m.innerText="Loading...",m.disabled=!0},c.onload=function(){if(200===c.status){window.uploadedFiles=[];var e=document.getElementById("nav-media-library-tab");if(e&&"function"==typeof e.click&&e.click(),m.disabled=!1,m.innerText="Save","undefined"!=typeof FileManager&&FileManager&&FileManager.state&&FileManager.state.currentFolder){var t=FileManager.state.currentFolder,n=document.getElementById("mediaLibraryContent");n&&(n.innerHTML=""),FileManager.state.nextOffset=0,FileManager.state.infiniteInitDone=!1,setTimeout(function(){"function"==typeof FileManager.loadFolderContents&&FileManager.loadFolderContents(t)},1e3)}else{var i=document.getElementById("media-container");page=1,i&&(i.innerHTML=""),v(),r&&r.addEventListener("scroll",f)}var a=document.getElementById("uploadedImages");a&&(a.innerHTML="")}},c.onerror=function(){m.disabled=!1,m.innerText="Save",alert("Upload failed. Please try again.")},c.onloadend=function(){200!==c.status&&(m.innerText="Save",m.disabled=!1)},c.send(a)}else document.getElementById("file_url_media").setAttribute("required","required"),document.getElementById("file_url_media-error").style.display="block",m.innerText="Save",m.disabled=!1;window.location.href==="".concat(n,"/app/media-library")&&window.location.reload()})),a&&a.addEventListener("hidden.bs.modal",function(){r&&r.removeEventListener("scroll",f)}),$("#add_more_video").click(function(){var e=$(".video-inputs-container").first();h(e);var t=e.clone();d++,t.find("input, select").each(function(){var e=$(this).attr("id");e&&$(this).attr("id",e+d);var t=$(this).attr("name");t&&$(this).attr("name",t+d),$(this).val("").trigger("change")}),t.find(".remove-video-input").removeClass("d-none"),t.find("[data-image-container]").each(function(){var e=$(this).attr("data-image-container");$(this).attr("data-image-container",e+d)}),t.find("[data-hidden-input]").each(function(){var e=$(this).attr("data-hidden-input");$(this).attr("data-hidden-input",e+d)}),t.find(".img-fluid").remove(),t.find(".remove-media-icon").remove(),t.find('input[type="hidden"]').val(""),t.find("div[id]").each(function(){var e=$(this).attr("id");e&&$(this).attr("id",e+d)}),$("#video-inputs-container-parent").append(t),y(t),p(t),l(),y(e)}),$(document).on("click",".remove-video-input",function(){$(this).closest(".video-inputs-container").remove()}),$("#add_more_download_video").click(function(){var e=$(".download-video-inputs-container").first();h(e);var t=e.clone();d++,t.find("input, select").each(function(){var e=$(this).attr("id");e&&$(this).attr("id",e+d);var t=$(this).attr("name");t&&$(this).attr("name",t+d),$(this).val("").trigger("change")}),t.find(".remove-download-video-input").removeClass("d-none"),t.find("[data-image-container]").each(function(){var e=$(this).attr("data-image-container");$(this).attr("data-image-container",e+d)}),t.find("[data-hidden-input]").each(function(){var e=$(this).attr("data-hidden-input");$(this).attr("data-hidden-input",e+d)}),t.find(".img-fluid").remove(),t.find(".remove-media-icon").remove(),t.find('input[type="hidden"]').val(""),t.find("div[id]").each(function(){var e=$(this).attr("id");e&&$(this).attr("id",e+d)}),$("#download-video-inputs-container-parent").append(t),y(t),g(t),l(),y(e)}),$(document).on("click",".remove-download-video-input",function(){$(this).closest(".download-video-inputs-container").remove()});var b=0;function E(e){var t=e.find(".clip_upload_type");function n(t){var n=e.find(".clip_video_file_input"),i=e.find(".clip_video_input"),a=e.find(".clip_video_embed_input");n.addClass("d-none"),i.addClass("d-none"),a.addClass("d-none"),"Local"===t?n.removeClass("d-none"):"Embedded"===t||"Embed"===t?a.removeClass("d-none"):"URL"!==t&&"YouTube"!==t&&"HLS"!==t&&"Vimeo"!==t&&"x265"!==t||i.removeClass("d-none")}n(t.val()),t.off("change.clip").on("change.clip",function(t){var i=$(this).val();if(n(i),t.originalEvent){var a=e.find('input[name="clip_file_input[]"]'),d=e.find('input[name="clip_url_input[]"]'),r=e.find('textarea[name="clip_embedded[]"]');"Local"===i?(d.length&&d.val("").trigger("change"),r.length&&r.val("").trigger("change")):"Embedded"===i||"Embed"===i?(d.length&&d.val("").trigger("change"),a.length&&a.val("").trigger("change")):(a.length&&a.val("").trigger("change"),r.length&&r.val("").trigger("change"))}})}function L(){var e=$(".clip-block"),t=e.first().find(".remove-clip-input");e.length>2?t.removeClass("d-none"):t.addClass("d-none")}$("#add_more_clip").off("click").on("click",function(){var e=$(".clip-block").first();if(0!==e.length){h(e);var t=e.clone();b++,t.find("input, select, textarea").each(function(){var e=$(this).attr("id");e&&$(this).attr("id",e+"_clip"+b),$(this).attr("name")&&$(this).val("")}),t.find(".remove-clip-input").removeClass("d-none"),t.find("[data-image-container]").each(function(){var e=$(this).attr("data-image-container");$(this).attr("data-image-container",e+"_clip"+b)}),t.find("[data-hidden-input]").each(function(){var e=$(this).attr("data-hidden-input");$(this).attr("data-hidden-input",e+"_clip"+b)}),t.find(".img-fluid").remove(),t.find(".remove-media-icon").remove(),t.find('input[type="hidden"]').val(""),t.find("div[id]").each(function(){var e=$(this).attr("id");e&&$(this).attr("id",e+"_clip"+b)}),$("#add_more_clip").closest(".text-end").before(t),y(t),E(t.find(".clips-inputs-container")),l(),y(e),L()}}),$(document).on("click",".remove-clip-input",function(){$(this).closest(".clip-block").remove(),L()}),L(),$(".video-inputs-container").each(function(){p($(this))}),$(".clips-inputs-container").each(function(){E($(this))}),$(".download-video-inputs-container").each(function(){g($(this))}),l(),y($(document))}),document.getElementById("file_url_media")&&document.getElementById("file_url_media").addEventListener("change",function(){var e=document.getElementById("file_url_media"),t=document.getElementById("uploadedImages"),n=31457280,i=[];if(t.innerHTML="",e.files.length>0)for(var a=0;a<e.files.length;a++){var d=e.files[a],r=Math.min(n,d.size);if(d.type.startsWith("video/")){var l=document.createElement("video");l.src=URL.createObjectURL(d),l.currentTime=1,l.addEventListener("loadeddata",function(){var e=document.createElement("canvas");e.width=l.videoWidth,e.height=l.videoHeight,e.getContext("2d").drawImage(l,0,0,e.width,e.height);var a=document.createElement("img");a.src=e.toDataURL("image/jpeg"),a.classList.add("img-fluid","iq-uploaded-image"),a.style.width="150px",a.style.height="100px";var c=document.createElement("div");c.classList.add("progress","mb-3","iq-progress"),c.style.visibility="hidden",c.innerHTML='\n                            <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                        ';var u=document.createElement("div");u.classList.add("iq-uploaded-image-close"),u.innerHTML="&times;",u.addEventListener("click",function(){i[0].removed=!0,this.parentNode.remove(),s()});var m=document.createElement("div");m.classList.add("iq-uploaded-image-container"),m.appendChild(a),m.appendChild(c),m.appendChild(u),t.appendChild(m);var v=i.length;i.push({file:d,removed:!1,progressBar:c.querySelector(".progress-bar"),done:!1}),updateUploadSubmitState(),c.style.visibility="visible",o(d,v,0,r,n,i,c)})}else{var c=new FileReader;c.onload=function(e,a){return function(d){var l=document.createElement("img");l.src=d.target.result,l.classList.add("img-fluid","iq-uploaded-image"),l.style.width="150px",l.style.height="100px";var c=document.createElement("div");c.classList.add("progress","my-3","iq-progress"),c.style.visibility="hidden",c.innerHTML='\n                                <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                            ';var u=document.createElement("div");u.classList.add("iq-uploaded-image-close"),u.innerHTML="&times;",u.addEventListener("click",function(){i[a].removed=!0,this.parentNode.remove(),s()});var m=document.createElement("div");m.classList.add("iq-uploaded-image-container"),m.appendChild(l),m.appendChild(c),m.appendChild(u),t.appendChild(m);var v=i.length;i.push({file:e,removed:!1,progressBar:c.querySelector(".progress-bar"),done:!1}),updateUploadSubmitState(),c.style.visibility="visible",o(e,v,0,r,n,i,c)}}(d,a),c.readAsDataURL(d)}}function s(){i.every(function(e){return e.removed})&&(e.value=null,i.length=0,document.getElementById("file_url_media").setAttribute("required","required"),document.getElementById("file_url_media-error").style.display="block"),updateUploadSubmitState()}window.uploadedFiles=i}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("loading-spinner"),t=document.getElementById("mediaLibraryContent"),n=document.getElementById("media-search"),i=document.getElementById("no_data"),r=1,o=!1,l=!0,c="",s=document.querySelector('meta[name="base-url"]').getAttribute("content");function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";o||!l&&""==t||(o=!0,e.style.display="block",fetch("".concat(s,"/app/media-library/getMediaStore?page=").concat(r,"&query=").concat(encodeURIComponent(t))).then(function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(function(e){e.html?(i.classList.add("d-none"),d.insertAdjacentHTML("beforeend",e.html),r++,!1):(d.innerHTML="",i.classList.remove("d-none"),$("#no_data").text("No data available")),l=e.hasMore}).catch(function(e){console.error("Error loading images:",e)}).finally(function(){o=!1,e.style.display="none"}))}function m(){t&&t.scrollTop+t.clientHeight>=t.scrollHeight-100&&u(c)}n&&n.addEventListener("input",function(){c=n.value,r=1,d.innerHTML="",u(c)});var v=document.getElementById("clear-search");function f(){n&&(n.value.length>0?v.classList.remove("d-none"):v.classList.add("d-none"))}n&&n.addEventListener("input",f),v&&v.addEventListener("click",function(){n.value="",f(),r=1,c="",o=!1,l=!0,d.innerHTML="",u(c)}),f(),a&&(a.addEventListener("shown.bs.modal",function(){d&&0===d.children.length&&u(c),t&&t.addEventListener("scroll",m)}),a.addEventListener("hidden.bs.modal",function(){t&&t.removeEventListener("scroll",m)}),d&&0===d.children.length&&u(c))}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("nav-upload-files-tab"),t=document.getElementById("nav-media-library-tab"),n=document.getElementById("media-search-container");if(t||e){var i=function(){t&&t.classList.contains("active")?n&&(n.style.display="block"):n&&(n.style.display="none")};t&&i(),e&&e.addEventListener("click",i),t&&t.addEventListener("click",i)}}),window.showValidationModal=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.getElementById("validationModal");i&&i.remove();var a=new Set,d=Object.entries(t).map(function(t){var i=e(t,2),d=i[0],r=i[1];if(!r||0===r.length)return"";var o=d.replace(/_/g," ").replace(/\b\w/g,function(e){return e.toUpperCase()}),l=n[d]||o,c=d.toLowerCase();c.includes("subtitle")?l=n.subtitles||l:c.includes("clip")?l=n.clips||l:c.includes("download")?l=n.download_info||l:l.toLowerCase().includes("subtitle")?l=n.subtitles||l:l.toLowerCase().includes("clip")?l=n.clips||l:l.toLowerCase().includes("download")&&(l=n.download_info||l);var s=r[0]?r[0].trim():"";if(!s)return"";var u=s;return a.has(u)?"":(a.add(u),"<li><strong>".concat(l,":</strong> ").concat(s,"</li>"))}).filter(function(e){return""!==e}).join(""),r=window.validationTranslations||{validation_errors:"Validation Errors",please_correct_errors:"Please correct the following errors:",close:"Close"},o='\n    <div class="modal fade" id="validationModal" tabindex="-1">\n      <div class="modal-dialog">\n        <div class="modal-content">\n          <div class="modal-header bg-danger text-white">\n            <h5 class="modal-title">'.concat(r.validation_errors,'</h5>\n            <button type="button" class="btn-close btn-close-white bg-white text-primary" data-bs-dismiss="modal"></button>\n          </div>\n          <div class="modal-body">\n            <p>').concat(r.please_correct_errors,"</p>\n            <ul>").concat(d,'</ul>\n          </div>\n          <div class="modal-footer">\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(r.close,"</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ");document.body.insertAdjacentHTML("beforeend",o),new bootstrap.Modal(document.getElementById("validationModal")).show()},window.showErrorCountOnTabs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};document.querySelectorAll(".error-badge").forEach(function(e){e.remove()}),Object.keys(t).forEach(function(n){var i=t[n]||[],a=0;if(a+=i.filter(function(t){return"*"!==t&&!!e[t]}).length,i.filter(function(e){return e.includes("*")}).forEach(function(t){var n=t.replace("*",".*"),i=new RegExp("^"+n+"$");Object.keys(e).forEach(function(e){i.test(e)&&a++})}),a>0){var d=document.querySelector('[data-bs-target="#'+n+'"]');if(d){var r=document.createElement("span");r.className="badge bg-danger error-badge ms-2",r.textContent=a,d.appendChild(r)}}})}})();
//# sourceMappingURL=media.min.js.map